
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tutorials for analysing bacterial omics data">
      
      
        <meta name="author" content="Anna Syme, Torsten Seemann">
      
      
        <link rel="canonical" href="http://sepsis-omics.github.io/tutorials/modules/viral_genomes/">
      
      
        <link rel="prev" href="../abricate/">
      
      
        <link rel="next" href="../workflows/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Viral genome sequencing - ABRPI-Training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#viral-genome-sequencing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ABRPI-Training" class="md-header__button md-logo" aria-label="ABRPI-Training" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ABRPI-Training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Viral genome sequencing
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sepsis-omics/tutorials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sepsis-omics/tutorials
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABRPI-Training" class="md-nav__button md-logo" aria-label="ABRPI-Training" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ABRPI-Training
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sepsis-omics/tutorials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sepsis-omics/tutorials
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Genomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Genomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshop_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genomics workshop overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../galaxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting with Galaxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-dna/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fastqc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Merge reads with Pear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../velvet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome assembly with Velvet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spades/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome assembly with Spades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prokka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snippy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variant finding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public data &rarr; assembly, annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abricate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Finding antibiotic-resistant genes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Viral genome sequencing
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Viral genome sequencing
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-data" class="md-nav__link">
    <span class="md-ellipsis">
      Import data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Import data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go-to-the-galaxy-page" class="md-nav__link">
    <span class="md-ellipsis">
      Go to the Galaxy Page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-files-to-galaxy" class="md-nav__link">
    <span class="md-ellipsis">
      Import files to Galaxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-make-the-newly-imported-history-appear-as-the-current-history" class="md-nav__link">
    <span class="md-ellipsis">
      To make the newly imported history appear as the current history:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snippy" class="md-nav__link">
    <span class="md-ellipsis">
      Snippy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Snippy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preliminary-activity" class="md-nav__link">
    <span class="md-ellipsis">
      Preliminary Activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-snippy" class="md-nav__link">
    <span class="md-ellipsis">
      Running Snippy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artemis" class="md-nav__link">
    <span class="md-ellipsis">
      Artemis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artemis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_2" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-reference-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      View the reference sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-artemis-window" class="md-nav__link">
    <span class="md-ellipsis">
      The Artemis window:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Add a plot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-draft-genome-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Producing a draft genome sequence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Producing a draft genome sequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_3" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examine-the-mapped-reads" class="md-nav__link">
    <span class="md-ellipsis">
      Examine the mapped reads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-an-overview-of-the-difference-between-strain-1-151-and-our-new-isolate" class="md-nav__link">
    <span class="md-ellipsis">
      Getting an Overview of the Difference between strain 1-151 and our new isolate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-more-detail-looking-at-the-table-of-snps" class="md-nav__link">
    <span class="md-ellipsis">
      Getting more detail: looking at the table of SNPs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Galaxy workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frogs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metagenomics with FROGS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kraken/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample identification with Kraken
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pacbio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PacBio assembly with SMRT portal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmdline_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PacBio assembly with command line tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spades_cmdline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spades assembly - commandline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mauve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome alignment with Mauve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pangenomes with Roary/Phandango - command line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roary-galaxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pangenomes with Roary/Phandango - Galaxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmdline_assembly_v2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Long read assembly workshop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transcriptomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Transcriptomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential gene expression using Galaxy and Degust
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kallisto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential gene expression using Kallisto and Degust
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Proteomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Proteomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xtandem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protein Identification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pathway_tools/annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pathway annotation and prediction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metabolomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Metabolomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xcms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolite identification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-data" class="md-nav__link">
    <span class="md-ellipsis">
      Import data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Import data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#go-to-the-galaxy-page" class="md-nav__link">
    <span class="md-ellipsis">
      Go to the Galaxy Page
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#import-files-to-galaxy" class="md-nav__link">
    <span class="md-ellipsis">
      Import files to Galaxy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-make-the-newly-imported-history-appear-as-the-current-history" class="md-nav__link">
    <span class="md-ellipsis">
      To make the newly imported history appear as the current history:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snippy" class="md-nav__link">
    <span class="md-ellipsis">
      Snippy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Snippy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_1" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preliminary-activity" class="md-nav__link">
    <span class="md-ellipsis">
      Preliminary Activity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-snippy" class="md-nav__link">
    <span class="md-ellipsis">
      Running Snippy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artemis" class="md-nav__link">
    <span class="md-ellipsis">
      Artemis
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artemis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_2" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-reference-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      View the reference sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-artemis-window" class="md-nav__link">
    <span class="md-ellipsis">
      The Artemis window:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Add a plot
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-draft-genome-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Producing a draft genome sequence
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Producing a draft genome sequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-overview_3" class="md-nav__link">
    <span class="md-ellipsis">
      Section overview:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examine-the-mapped-reads" class="md-nav__link">
    <span class="md-ellipsis">
      Examine the mapped reads
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-an-overview-of-the-difference-between-strain-1-151-and-our-new-isolate" class="md-nav__link">
    <span class="md-ellipsis">
      Getting an Overview of the Difference between strain 1-151 and our new isolate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-more-detail-looking-at-the-table-of-snps" class="md-nav__link">
    <span class="md-ellipsis">
      Getting more detail: looking at the table of SNPs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<p><br></p>
<h1 id="viral-genome-sequencing">Viral Genome Sequencing</h1>
<p>This tutorial is about determining the genome sequence of a virus, using comparisons to a reference sequence.</p>
<h2 id="background">Background</h2>
<p>Murray Valley encephalitis virus is classified as part of the Flavivirus genus of viruses, all of which are positive strand RNA viruses. The type species for this genus is yellow fever virus, and the genus includes dengue virus, west nile virus and zika virus.</p>
<p>Viruses from this genus have a single-segment genome of about 11 kb. Within this, there is a 10 kb open reading frame that encodes a polyprotein. Following translation, this protein is modified to yield the various, mature structural and non-structural viral proteins as illustrated in Fig. 1.</p>
<p><img alt="flavivirus" src="images/flavivirus.png" /></p>
<p>Fig. 1 - An overview of a typical flavivirus genome and the viral proteins that are part of the viral polyprotein (from <a href="http://viralzone.expasy.org/all_by_species/24.html">Viralzone</a>).</p>
<p>There are 14 complete Murray Valley encephalitis virus genome sequences available at NCBI Viral Genomes.</p>
<ul>
<li>Go to NCBI <a href="https://www.ncbi.nlm.nih.gov/genome/viruses/">Viral Genomes</a>.</li>
<li>Select <ss>Browse viral genomes by family</ss> and click on the family <ss>Flaviviridae</ss>: <ss>Complete Genomes</ss></li>
<li>Note: you may have to widen your screen to see all the columns of viral family names.</li>
</ul>
<p><img alt="ncbi_genomes" src="images/ncbi.png" /></p>
<ul>
<li>Look at the row for Murray Valley encephelitis virus. In the Neigbours column, we can see there are 14.</li>
</ul>
<!--

: click on the 14 and then Entrez Nucleotide

![mvev_neighbours](images/mvev_seqs.png)

This brings up a list of all the strains on NCBI.

following seq though is not in this list?
-->

<p>In this tutorial we will use the prototype strain 1-151 as the reference genome sequence.</p>
<ul>
<li>This strain was isolated in the early 1950s - see <a href="https://www.ncbi.nlm.nih.gov/pubmed/10567642">AF161266</a>.</li>
</ul>
<!-- Dieter
- [are we using this AF seq exactly? or if not, which seq]

- [This seq is not in the list of 14 --- does this mean it is just more distant and therefore didn't align closely?]
-->

<p>The isolate we are looking at has been sequenced using the Illumina platform.</p>
<ul>
<li>The genomic cDNA was prepared using random hexamers to prime the reverse transcription of the viral genomic RNA.</li>
<li>After second strand synthesis, the cDNA was used to prepare an Illumina sequencing library and run on an Illumina MiSeq instrument.</li>
</ul>
<p>In this activity we will use a read mapping approach to determine the sequence of a new Murray Valley encephalitis virus isolate.</p>
<h2 id="import-data">Import data</h2>
<h3 id="section-overview">Section overview:</h3>
<ul>
<li>Log in to your Galaxy server</li>
<li>Import files required for the activity</li>
<li>View imported files</li>
</ul>
<h3 id="go-to-the-galaxy-page">Go to the Galaxy Page</h3>
<ul>
<li>Web address: <a href="http://phln.genome.edu.au/galaxy">http://phln.genome.edu.au/galaxy</a></li>
<li><a href="https://docs.google.com/document/d/10meAZA7-OsD_PglLD2zL3m-EwkemFxVnRVUYGAmtOz4/pub">Remind me how to logon</a></li>
</ul>
<h3 id="import-files-to-galaxy">Import files to Galaxy</h3>
<ul>
<li>Click on the <ss>Analyze Data</ss> menu at the top of the page.</li>
<li>Click on the <ss>History</ss> menu button (the <img alt="cog" src="images/cog.png" /> on the top right of the history pane)</li>
<li>Click <ss>Import from File</ss> (at the bottom of the list)</li>
<li>A new page will appear with a text box for the URL of the history to import.</li>
<li>Copy the following URL into the text box:</li>
<li>
<p><fn>http://phln.genome.edu.au/public/dieter/Galaxy-History-MVEVmapping.tar.gz</fn></p>
</li>
<li>
<p>Click <ss>Submit</ss></p>
</li>
<li>Galaxy will download the data files from the internet and will be available as an additional history (takes about one minute).</li>
</ul>
<h3 id="to-make-the-newly-imported-history-appear-as-the-current-history">To make the newly imported history appear as the current history:</h3>
<ul>
<li>Click on the View all Histories button (the <img alt="Galaxy-histories" src="images/Galaxy-histories.png" /> on the top right of the history pane.)</li>
<li>If the history has finished downloading it will appear with the title:</li>
<li><fn>“imported from archive: MVEVmapping“</fn></li>
<li>Click on the <ss>Switch to</ss> button above this history and then the <ss>Done</ss> button.</li>
</ul>
<p>You should now have 4 files in the history pane as follows:</p>
<p><img alt="mvev_files" src="images/mvev_files.png" /></p>
<p>Reference sequence files <!-- Dieter: [from AF161266?]--> :</p>
<ul>
<li><fn>MVEV.gbk</fn> - genbank format</li>
<li><fn>MVEV.fna</fn> - fasta format</li>
</ul>
<p>Illumina sequence reads (R1 and R2) from the new isolate:</p>
<ul>
<li><fn>MVE_R1.fq</fn> - forward reads</li>
<li><fn>MVE_R2.fq</fn> - reverse reads</li>
</ul>
<h2 id="snippy">Snippy</h2>
<h3 id="section-overview_1">Section overview:</h3>
<ul>
<li>Find variants in the isolate using the tool Snippy.</li>
</ul>
<p>Snippy is a fast variant caller for haploid genomes. The software is available on GitHub at <a href="https://github.com/tseemann/snippy">https://github.com/tseemann/snippy</a>. For this activity, we are using Snippy as installed on Galaxy.</p>
<h3 id="preliminary-activity">Preliminary Activity</h3>
<ul>
<li>
<p>Run FastQC: How many reads in in each of the fastq files <fn>MVE_R1.fq</fn> and <fn>MVE_R2.fq</fn>?</p>
</li>
<li>
<p><fn>MVEV.fna</fn> and <fn>MVEV.gbk</fn> each contain the genome sequence of Murray Valley encephalitis virus strain 1-151 - how many bases in the genome? (Hint: use Fasta Statistics)</p>
</li>
</ul>
<h3 id="running-snippy">Running Snippy</h3>
<p>Snippy maps reads from the new Murray Valley encephalitis virus isolate (the <fn>MVE_R1.fq</fn> and <fn>MVE_R2.fq</fn> reads) onto the genome sequence of Murray Valley encephalitis virus strain 1-151 (<fn>MVEV.fna</fn>). <!-- Dieter: [or gbk? that's in the screenshot] --></p>
<ul>
<li>Find Snippy in the tool menu (in  NGS: Variant Analysis)</li>
<li>Select appropriate files (see screenshot below) and Execute (use default settings).</li>
</ul>
<p><img alt="snippy_window" src="images/snippy.png" /></p>
<h3 id="output">Output</h3>
<p>Files cataloging SNP differences:</p>
<ul>
<li>9: <fn>snippy on data 4, data 3, and data 2 snps vcf file</fn></li>
<li>10: <fn>snippy on data 4, data 3, and data 2 snps gff file</fn></li>
<li>11: <fn>snippy on data 4, data 3, and data 2 snps table</fn></li>
<li>12: <fn>snippy on data 4, data 3, and data 2 snps summary</fn></li>
</ul>
<p>A log of the progress of the run:</p>
<ul>
<li>13: <fn>snippy on data 4, data 3, and data 2 log file</fn></li>
</ul>
<p>Regions where reads aligned (NNNN &mdash;, indicate regions where there was low or no read data):</p>
<ul>
<li>14: <fn>snippy on data 4, data 3, and data 2 aligned fasta</fn></li>
</ul>
<p>A consensus genome sequence for the new isolate:</p>
<ul>
<li>15: <fn>snippy on data 4, data 3, and data 2 consensus fasta</fn></li>
</ul>
<p>Summary of the read depth:</p>
<ul>
<li>16: <fn>snippy on data 4, data 3, and data 2 mapping depth</fn></li>
</ul>
<p>A compressed version of the above files (and more that can be downloaded):</p>
<ul>
<li>17: <fn>snippy on data 4, data 3, and data 2 out dir</fn></li>
</ul>
<p>Download these files to your local computer (click on the file name and then the disk icon in the lower left hand corner):</p>
<ul>
<li>17: <fn>snippy on data 4, data 3, and data 2 out dir</fn> (and unzip)</li>
<li>2: <fn>MVEV.gbk</fn></li>
<li>1: <fn>MVEV.fna</fn></li>
</ul>
<p>Also download these bam files from these URLs (open each URL in a new tab and the file should download automatically):</p>
<ul>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.bam">http://phln.genome.edu.au/public/dieter/snps.bam</a></li>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.bam.bai">http://phln.genome.edu.au/public/dieter/snps.bam.bai</a></li>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.depth.gz">http://phln.genome.edu.au/public/dieter/snps.depth.gz</a></li>
<li><a href="http://phln.genome.edu.au/public/dieter/snps.depth.gz.tbi">http://phln.genome.edu.au/public/dieter/snps.depth.gz.tbi</a></li>
</ul>
<p>Note: if you have previously downloaded these files, the new downloads may be renamed. Remove any spaces in the names.</p>
<!-- Dieter:
[Should we explain why we have these four other files - where they are from, what they are needed for, etc - so if people are repeating this exercise on their own they can follow]

-->

<h2 id="artemis">Artemis</h2>
<h3 id="section-overview_2">Section overview:</h3>
<ul>
<li>View the reads from the new isolate mapped against the reference sequence, using the tool Artemis.</li>
</ul>
<p>Artemis is a tool to view genome sequences and mapped reads, including variants (SNPs).</p>
<p>If Artemis is not installed, go to <a href="http://www.sanger.ac.uk/science/tools/artemis">http://www.sanger.ac.uk/science/tools/artemis</a>.</p>
<h3 id="view-the-reference-sequence">View the reference sequence</h3>
<ul>
<li>Open Artemis.</li>
<li>Go to <ss>File: Open</ss> and select <fn>MVEV.gbk</fn>. The file will probably have a &ldquo;Galaxy&rdquo; prefix, e.g. <fn>Galaxy2-[MVEV.gbk].genbank</fn>.</li>
</ul>
<h3 id="the-artemis-window">The Artemis window:</h3>
<ul>
<li>panes 1 and 2 are the same, but can be scaled differently</li>
<li>each pane has the double-stranded sequence in the centre, with amino acid translations above and below</li>
<li>there is a third lower pane with feature information</li>
<li>coding sequences are highlighted in blue</li>
<li>other features are highlighted in green</li>
<li>clicking on one of these will select it in all panels</li>
<li>black vertical lines are stop codons (when zoomed out)</li>
<li>move left and right with horizontal scroll bar</li>
<li>zoom in and out with right-hand scroll bar</li>
</ul>
<p><img alt="artemis_window" src="images/artemis.png" /></p>
<h3 id="add-a-plot">Add a plot</h3>
<ul>
<li>Go to <ss>Graph: Add User Plot</ss>, select <fn>snps.depth.gz</fn></li>
<li>A graph should display at the top of the screen <!-- Dieter:  [is this depth of reads or depth of snps?] --></li>
</ul>
<p><img alt="depth-plot" src="images/depth-plot.png" /></p>
<!-- need to finish this bit :

The file that is used to produce the graph is a 3 column table (part of the file is shown below)

[what is the file name?]

                 …
Column 1: the name of the sequence, Column 2: the position in the sequence, Column 1: the read depth at that position

-->

<h2 id="producing-a-draft-genome-sequence">Producing a draft genome sequence</h2>
<h3 id="section-overview_3">Section overview:</h3>
<ul>
<li>Produce draft genome sequence for the new viral isolate.</li>
</ul>
<h3 id="examine-the-mapped-reads">Examine the mapped reads</h3>
<!-- [or title for this section? ] -->

<p>What is the minimum read depth used by Snippy to call a SNP?</p>
<ul>
<li>Hint: Go back to Snippy on Galaxy - look at the information below the ‘Execute’ button</li>
</ul>
<p>Would Snippy call a SNP at positions 1 → 5 ?</p>
<p>What is the maximum read depth?</p>
<p>What do we know about the sequence of the new isolate in the regions where there is low read coverage?</p>
<!-- [close first Artemis window?] -->

<ul>
<li>Unzip <fn>17: snippy on data 4, data 3, and data 2 out dir</fn></li>
<li>
<p>This makes an &ldquo;out&rdquo; folder containing some files including the consensus file.</p>
</li>
<li>
<p>In Artemis, open <fn>snps.consensus.fa</fn></p>
</li>
</ul>
<p>This is a file that is based on the reference sequence and includes any confirmed SNPs called by Snippy.</p>
<p>If we were going to use this sequence to produce the draft sequence of the new isolate, what bases would you have at positions 1→ 5?</p>
<h3 id="getting-an-overview-of-the-difference-between-strain-1-151-and-our-new-isolate">Getting an Overview of the Difference between strain 1-151 and our new isolate</h3>
<p>Simplest overview: view the bam file with Artemis</p>
<p>Open <fn>MVEV.gbk</fn> in Artemis and load the <fn>snps.bam</fn> via the File menu to “Read BAM / VCF”</p>
<p>Once loaded, differences between reads and the reference sequence can be highlighted by right/command click in the bam view window. Select ‘Show &gt; SNP marks’.</p>
<p><img alt="bam" src="images/bam.png" /></p>
<h3 id="getting-more-detail-looking-at-the-table-of-snps">Getting more detail: looking at the table of SNPs</h3>
<p>Located in the out folder there is a html file that contains a table with information about each of the SNPs called by Snippy.</p>
<p>Included in the table is a column that provides a prediction about the impact each SNP will have on annotated protein coding regions. The genbank file provides the annotation information used by Snippy to make the predictions.</p>
<p>A total of 790 SNP differences were call by Snippy</p>
<p>Open snps.html in your web browser</p>
<!-- [screenshot] -->

<p>Summary: 663/790 SNPs do not result a difference in the encoded polyprotein</p>
<p>Is this pattern of variable genome sequence and more conserved protein sequence normal in viruses? What might be the cause?</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; The authors; 2016-
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>