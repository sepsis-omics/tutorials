
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Tutorials for analysing bacterial omics data">
      
      
        <meta name="author" content="Anna Syme, Torsten Seemann">
      
      
        <link rel="canonical" href="http://sepsis-omics.github.io/tutorials/modules/frogs/">
      
      
        <link rel="prev" href="../workflows/">
      
      
        <link rel="next" href="../kraken/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Metagenomics with FROGS - ABRPI-Training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/sepsis.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metagenomics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ABRPI-Training" class="md-header__button md-logo" aria-label="ABRPI-Training" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ABRPI-Training
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Metagenomics with FROGS
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/sepsis-omics/tutorials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sepsis-omics/tutorials
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ABRPI-Training" class="md-nav__button md-logo" aria-label="ABRPI-Training" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ABRPI-Training
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sepsis-omics/tutorials" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    sepsis-omics/tutorials
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Genomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Genomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshop_overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genomics workshop overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../galaxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting with Galaxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data-dna/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training dataset
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fastqc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quality control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pear/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Merge reads with Pear
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../velvet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome assembly with Velvet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spades/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome assembly with Spades
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prokka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snippy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variant finding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../access_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public data &rarr; assembly, annotation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../abricate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Finding antibiotic-resistant genes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../viral_genomes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viral genome sequencing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Galaxy workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Metagenomics with FROGS
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Metagenomics with FROGS
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get-data" class="md-nav__link">
    <span class="md-ellipsis">
      Get data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-pre-process" class="md-nav__link">
    <span class="md-ellipsis">
      1. Pre-process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Pre-process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    <span class="md-ellipsis">
      Run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-clustering-swarm" class="md-nav__link">
    <span class="md-ellipsis">
      2. Clustering swarm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Clustering swarm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-remove-chimera" class="md-nav__link">
    <span class="md-ellipsis">
      3. Remove chimera
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Remove chimera">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_2" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-filters" class="md-nav__link">
    <span class="md-ellipsis">
      4. Filters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Filters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_3" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-affiliation-otu" class="md-nav__link">
    <span class="md-ellipsis">
      5. Affiliation OTU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Affiliation OTU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_4" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-affiliations-stat" class="md-nav__link">
    <span class="md-ellipsis">
      6. Affiliations stat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Affiliations stat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_5" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kraken/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sample identification with Kraken
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pacbio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PacBio assembly with SMRT portal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmdline_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PacBio assembly with command line tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spades_cmdline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spades assembly - commandline
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mauve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Genome alignment with Mauve
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pangenomes with Roary/Phandango - command line
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../roary-galaxy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pangenomes with Roary/Phandango - Galaxy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cmdline_assembly_v2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Long read assembly workshop
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transcriptomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Transcriptomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential gene expression using Galaxy and Degust
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kallisto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differential gene expression using Kallisto and Degust
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Proteomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Proteomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xtandem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protein Identification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pathway_tools/annotation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pathway annotation and prediction
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Metabolomics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Metabolomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xcms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metabolite identification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get-data" class="md-nav__link">
    <span class="md-ellipsis">
      Get data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-pre-process" class="md-nav__link">
    <span class="md-ellipsis">
      1. Pre-process
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Pre-process">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#run" class="md-nav__link">
    <span class="md-ellipsis">
      Run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-clustering-swarm" class="md-nav__link">
    <span class="md-ellipsis">
      2. Clustering swarm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Clustering swarm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-remove-chimera" class="md-nav__link">
    <span class="md-ellipsis">
      3. Remove chimera
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Remove chimera">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_2" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-filters" class="md-nav__link">
    <span class="md-ellipsis">
      4. Filters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Filters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_3" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-affiliation-otu" class="md-nav__link">
    <span class="md-ellipsis">
      5. Affiliation OTU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Affiliation OTU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_4" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-affiliations-stat" class="md-nav__link">
    <span class="md-ellipsis">
      6. Affiliations stat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Affiliations stat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#output_5" class="md-nav__link">
    <span class="md-ellipsis">
      Output
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<p><br></p>
<h1 id="metagenomics">Metagenomics</h1>
<p>Metagenomics aims to compare microbial communities from different environments by using information from the metagenome. Typically, 16S rRNA is used when classifying taxa, and whole-genome sequencing when aiming to identify gene functions and pathways.</p>
<!-- - compare microbial communities from different environments: do this by comparing the metagenome: e.g. GC-content, k-mers, size, how many spp, functions of genes
- eg for function, can compare to a database (COG or KEGG) and see whether metagenomes differ (statistically test) -
- More about 16S rRNA: The 16S sequence is RNA that makes up part of the bacterial ribosome (together with other rRNA and protein). The operon is 16S, 23S, 5S - and there may be many copies of the operon (7 in E coli).
-->

<p>This tutorial covers the tool called FROGS (in Galaxy): &ldquo;Find Rapidly OTU with Galaxy Solution&rdquo;.</p>
<!-- dental and phln only? -->

<!-- - uses a different way of clustering similar sequences into OTUs. -->

<h2 id="get-data">Get data</h2>
<ul>
<li>
<p>The data: paired-end Illumina reads from two environmental samples. <!-- two env samples? dental microbiomes?--></p>
</li>
<li>
<p>In Galaxy, in the history panel, click on the cog item, and select &ldquo;import from file&rdquo;.</p>
<ul>
<li>In the &ldquo;Archived History URL:&rdquo; box paste:</li>
<li>
<p><tt>https://swift.rc.nectar.org.au:8888/v1/AUTH_377/public/Microbial_tutorials/Galaxy-History-16S_metagenomics_dataset.tar.gz</tt></p>
</li>
<li>
<p>You should now have four files in your Galaxy history.</p>
</li>
</ul>
</li>
</ul>
<!-- - Download the <fn>.tar.gz</fn> file to your local computer using this link: <https://drive.google.com/open?id=0B-DKulJTTftlT2djQmJ4aTN6Q1U>.
- Click on the file to unzip it into four <fn>.gz</fn> files. These can stay zipped.
- In Galaxy, go to <ss>Get Data: Upload File</ss>. Choose the the four files, set their file type to "fastqsanger", click start, then close.
- The four files should now be in your current history.
-->

<!-- I have renamed these files as microbiomeA_R1 and microbiomeB_R1 etc -->

<ul>
<li>In the Galaxy tools panel, in the top search bar, type FROGS.<ul>
<li>This will bring up the various tools available.</li>
<li>We will be using 6 of these tools.</li>
</ul>
</li>
</ul>
<p><img alt="frogs_tools" src="images/frogs_tools.png" /></p>
<h2 id="1-pre-process">1. Pre-process</h2>
<p>This is the first step in the Frogs analysis. It takes in the forward and reverse sequencing reads (R1 and R2) from multiple samples (e.g. microbiome A and microbiome B) and performs the following steps:</p>
<ul>
<li>If the data is not in contigs, read1 and read2 will be overlapped (allowing some mismatch in overlapping region).</li>
<li>Contigs that are too big or too small will be filtered out. <!-- what's wrong with too big?--></li>
<li>If using the Illumina standard protocol: will look for those primers, filter out contigs without primers, and cut the primer sequences.</li>
<li>Sequences that are too small or of poor quality will be filtered out.</li>
<li>Sequences will be de-replicated: duplicates will be removed but the number of duplicates will be recorded.</li>
</ul>
<h3 id="run">Run</h3>
<p>Go to <ss>FROGS Pre-process</ss> and select the following:</p>
<ul>
<li><ss>Sequencer</ss>: Illumina</li>
<li><ss>Input type</ss>: Files by samples</li>
<li><ss>Reads alread contiged?</ss>: No</li>
<li><ss>Samples</ss>:<ul>
<li><ss>Name</ss>: microbiomeA &lt;<em>note: no spaces</em>&gt;</li>
<li><ss>Reads1</ss>: <fn>microbiomeA_R1.fq</fn></li>
<li><ss>Reads2</ss>: <fn>microbiomeA_R2.fq</fn></li>
<li><ss>Insert Samples</ss>- click plus sign</li>
<li><ss>Name</ss>: microbiomeB</li>
<li><ss>Reads1</ss>: <fn>microbiomeB_R1.fq</fn></li>
<li><ss>Reads2</ss>: <fn>microbiomeB_R2.fq</fn></li>
</ul>
</li>
<li><ss>Reads 1 size</ss>: 250</li>
<li><ss>Reads 2 size</ss>: 250</li>
<li><ss>Expected amplicon size</ss>: 420</li>
<li><ss>Minimum amplicon size</ss>: 380</li>
<li><ss>Maximum amplicon size</ss>: 460</li>
<li><ss>Sequencing protocol</ss>: Illumina standard</li>
<li><ss>5&rsquo; primer</ss>: GGCGVACGGGTGAGTAA</li>
<li><ss>3&rsquo; primer</ss>: GTGCCAGCNGCNGCGG &lt;<em>note: needs to be in 5&rsquo; to 3&rsquo; orientation</em>&gt;</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="pre-process" src="images/pre-process.png" /></p>
<h3 id="output">Output</h3>
<p>There are three output files. Click on the eye icon for each to see their contents.</p>
<p>Report:</p>
<ul>
<li>The <fn>report.html</fn> shows how samples were filtered. For example, in the bar chart called &ldquo;Filtering summary&rdquo;, the number of reads kept at each filtering stage is displayed. We would expect some decrease in some of these categories, but if many reads have been filtered at a particular stage it could indicate poor quality data.</li>
</ul>
<p><img alt="filtering_summary1" src="images/filtering_summary1.png" /></p>
<ul>
<li>Below this chart, a table shows the statistics for each sample. Check the boxes next to &ldquo;microbiomeA&rdquo; and &ldquo;microbiomeB&rdquo; and then click <ss>Display amplicon lengths</ss> - shows amplicon distribution before filtering. Click <ss>Display preprocessed amplicon lengths</ss> - shows the distribution has been narrowed after filtering. Check if both samples are similar.</li>
</ul>
<p>Counts:</p>
<ul>
<li>The <fn>counts.tsv</fn> file is a list of sequences and their counts in the two samples.</li>
</ul>
<p>Fasta file:</p>
<ul>
<li>The <fn>dereplicated.fasta</fn> contains the sequences, without any duplicates.</li>
</ul>
<h2 id="2-clustering-swarm">2. Clustering swarm</h2>
<p>In this step, sequences are clustered into groups using Swarm (more information about <a href="https://peerj.com/articles/593/">Swarm</a>). This takes the pre-processed <fn>fasta</fn> and <fn>counts</fn> files and does the following:</p>
<ul>
<li>Sorts reads by abundance.</li>
<li>Clusters the reads into pre-clusters using Swarm and distance parameter of 1.</li>
<li>Sorts these pre-clusters by abundance.</li>
<li>Cluster the pre-clusters using Swarm and a user-specified distance.</li>
</ul>
<p>Go to <ss>FROGS Clustering swarm</ss> and select the following:</p>
<ul>
<li><ss>Sequences files</ss>: <fn>dereplicated.fasta</fn></li>
<li><ss>Counts file</ss>: <fn>count.tsv</fn></li>
<li><ss>Aggregation distance</ss>: 3</li>
<li><ss>Perform deionising clustering step?</ss>: Yes</li>
<li><ss>Execute</ss></li>
</ul>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<p><img alt="clustering" src="images/clustering.png" /></p>
<h3 id="output_1">Output</h3>
<p>There are three output files.</p>
<ul>
<li>The <fn>abundance.biom</fn> shows the abundance of each cluster.</li>
<li>The <fn>seed_sequences.fasta</fn> contains the the cluster (OTU) representative sequences. <!-- the seqs used to start clustering? not the final clusterss? --></li>
<li>The <fn>swarms.composition.tsv</fn> shows what is in each cluster.</li>
</ul>
<h2 id="3-remove-chimera">3. Remove chimera</h2>
<p>Closely-related sequences may form chimeras (mixed sequences) during PCR (libray prep). This step removes these sequences by the following method:</p>
<ul>
<li>Splits input data into samples</li>
<li>Uses vsearch to find chimeras in each sample</li>
<li>Removes chimeras</li>
</ul>
<p>Go to <ss>FROGS Remove chimera</ss> and select the following:</p>
<ul>
<li><ss>Sequences file</ss>: <fn>seed_sequences.fasta</fn></li>
<li><ss>Abundance type</ss>: <fn>BIOM file</fn></li>
<li><ss>Abundance file</ss>: <fn>abundance.biom</fn></li>
<li><ss>Execute</ss></li>
</ul>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<p><img alt="chimera" src="images/chimera.png" /></p>
<h3 id="output_2">Output</h3>
<p>There are three output files.</p>
<ul>
<li>The <fn>non_chimera.fasta</fn> is a filtered file containing no chimeras.</li>
<li>The <fn>non_chimera_abundance.biom</fn> is a filtered abundance file containing no chimeras.</li>
<li>The summary <fn>report.html</fn>. In this case, although almost 70% of the clusters were removed, more than 70% of the actual reads were kept.</li>
</ul>
<p><img alt="remove-summary" src="images/remove_summary.png" /></p>
<h2 id="4-filters">4. Filters</h2>
<p>The OTUs (Operational Taxonomic Units) have now been clustered. In this step, we will filter out some of the OTUs that are either not in both samples, and/or contain at least 0.005% of all the sequences.</p>
<p>Go to <ss>FROGS Filters</ss> and select the following:</p>
<ul>
<li><ss>Sequences file</ss>: <fn>non_chimera.fasta</fn></li>
<li><ss>Abundance file</ss>:  <fn>non_chimera_abundance.biom</fn></li>
<li><ss>*** THE FILTERS ON OTUS IN SAMPLES, OTUS SIZE and SEQUENCE PERCENTAGE</ss>: Apply filters</li>
<li><ss>Minimum number of samples</ss>: 2</li>
<li><ss>Minimum proportion/number of sequences to keep OTU</ss>: 0.00005</li>
<li><ss>N biggest OTU</ss>: leave blank</li>
<li><ss>*** THE FILTERS ON RDP</ss>: No filters</li>
<li><ss>*** THE FILTERS ON BLAST</ss>: No filters</li>
<li><ss>*** THE FILTERS ON CONTAMINATIONS</ss>: No filters</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="filters" src="images/filters.png" />]</p>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<h3 id="output_3">Output</h3>
<p>There are four output files.</p>
<ul>
<li><fn>sequences.fasta</fn>: the retained sequences.</li>
<li><fn>abudance.biom</fn>: the abundance file.</li>
<li><fn>excluded.tsv</fn>: discarded OTUs</li>
<li><fn>report.html</fn>: this shows the proportion of OTUs and the proportion of sequences kept. In this example, although most OTUs have been filtered out, most sequences have been retained.</li>
</ul>
<p><img alt="filters_summary" src="images/filters_summary.png" /></p>
<!-- We should do 3+ samples
Then could click on Venn diagram here and see intersection.
-->

<h2 id="5-affiliation-otu">5. Affiliation OTU</h2>
<p>An OTU is a cluster of sequences. This step adds the taxonomy to the abundance file. It uses the SILVA database for rRNA.<!--add more info about Silva--></p>
<!-- - that has been filtered for only (16S or all 30S?), non-redundant, keeping certain taxonomic levels, and split into pro and eukaryotes.

blastn+ to align each OTU against seqs in the dbase, keeping the best.
- It can return multi-affiliation - see notes below tool panel.

-->

<p>Go to <ss>FROGS Affiliation OTU</ss> and select:</p>
<ul>
<li><ss>Using reference database</ss>: silva123</li>
<li><ss>Also perform RDP assignation</ss>: No</li>
<li><ss>OTU seed sequence</ss>: <fn>sequences.fasta</fn> from step 4</li>
<li><ss>Abundance file</ss>: <fn>abundance.biom</fn> from step 4</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="otu" src="images/otu.png" /></p>
<p><em>Note: Galaxy may say that the job submission has failed. Click Close, then click refresh in the top of the history panel. The job should be running.</em></p>
<!-- can take 10 mins or so? -->

<h3 id="output_4">Output</h3>
<p>There are two output files.</p>
<ul>
<li>
<p><fn>affiliation.biom</fn>: the abundance file with affiliation. Note: this <fn>.biom</fn> file is not human-readable. If you wish, you can convert it with the FROGS <strong>biom to tsv</strong> tool.</p>
</li>
<li>
<p><fn>report.html</fn>: the report shows the proportion of OTUs and sequences affiliated to sequences in the database. Here we can see that almost all OTUs and sequences have been taxonomically assigned, but almost 10% of OTUs could be assigned to multiple species. <!--is that interpreation correct?--></p>
</li>
</ul>
<p><img alt="blast_summary" src="images/blast_affiliation.png" /></p>
<h2 id="6-affiliations-stat">6. Affiliations stat</h2>
<p>This step computes some statistics from the analysis and generates a report of the OTUs/taxonomy found.</p>
<p>Go to <ss>FROGS Affiliations stat</ss> and select:</p>
<ul>
<li><ss>Abundance file</ss>: <fn>affiliation.biom</fn> from step 5</li>
<li><ss>Rarefaction ranks</ss>: Class Order Family Genus Species</li>
<li><ss>Affiliation processed</ss>: FROGS blast</li>
<li><ss>Execute</ss></li>
</ul>
<p><img alt="otu-stat" src="images/otu-stat.png" /></p>
<h3 id="output_5">Output</h3>
<p>There is one output file. Click on the eye icon next to <fn>summary.html</fn>:</p>
<ul>
<li>click on <ss>Display global distribution</ss>: this shows the taxonomy of the sample. Start at the centre; major groups each have a segment by colour; as you go outwards, taxonomic identification becomes more specific. <!-- this is the pooled info from both samples? --> Click on a segment to display a table of statisics below. Click on the cross in the top right corner to exit.</li>
</ul>
<p><img alt="taxa-distribution" src="images/taxa_distribution.png" /></p>
<!--is there a way to summarize this info across samples? eg sample 1 had lots of taxon A compared to sample 2 etc... or this taxon found only in sample B etc... (although I think these ones were filtered out)? -->

<ul>
<li>Next, we will look at the rarefaction curve, which is a measure of samples vs diversity. <!-- is that correct? In other words, how many samples do we have to take before we are covering the taxonomic diversity?--> Click on the boxes next to each of the samples (both, or one at a time) in the table (microbiomeA and microbiomeB). Click <ss>Display rarefaction</ss>.</li>
</ul>
<p><img alt="rarefaction" src="images/rarefaction.png" /></p>
<h2 id="links">Links</h2>
<ul>
<li>FROGS slides by Yvan Le Bras <a href="https://f1000research.com/slides/5-1832">https://f1000research.com/slides/5-1832</a></li>
<li>The SILVA database: <a href="https://www.arb-silva.de/">https://www.arb-silva.de/</a></li>
<li>Other metagenomics software:<ul>
<li>QIIME: <a href="http://qiime.org/">http://qiime.org/</a>    </li>
<li>UPARSE: <a href="http://www.drive5.com/uparse/">http://www.drive5.com/uparse/</a></li>
<li>MOTHUR: <a href="https://www.mothur.org/">https://www.mothur.org/</a></li>
<li>MG-RAST: <a href="http://metagenomics.anl.gov/">http://metagenomics.anl.gov/</a></li>
</ul>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; The authors; 2016-
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>